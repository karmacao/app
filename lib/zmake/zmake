#!/usr/bin/python

# file : zmake
# des : zmake file, python script
# author : zhaodongwei (joodaw@gmail.com)
# org : nju

import os
import sys
import shutil

def generate_ZMAKE():
	f = open("ZMAKE", "w")
	f.write("""This is a ZMAKE file generated by zmake
root("./././")

#complier
COMPLIER = "g++"

#gcc flag
FLAG = "-O 2" 

#config lib
libconfig()

#head file
header = "./include/*"
src = "./src/*"

application("exe", "name", src, header)
application("static", "libname.a", src, header)

"""
	)
	f.close()

def generate_Makefile():
	f = open("ZMAKE", "r")
	for line in f:
		print line,
	f.close()

mode = 0
for i in sys.argv:
	if (i == "-s"):
		mode = 1
	if (i == "-n"):
		mode = 2
	if (i == "-u"):
		mode = 3

if (1 == mode):
	print "set up mode, copying files"
	#os.system("cp zmake /usr/bin")
	shutil.copyfile("./zmake", "/usr/bin/zmake")
elif (2 == mode):
	print "initialize mode, building ZMAKE"
	generate_ZMAKE()
elif (3 == mode):
	print "update lib mode, building libs"
elif (0 == mode):
	print "makefile mode, generating Makefile"
	generate_Makefile()
else:
	print "error occurs"

